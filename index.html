<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Dynamics CRM Bookmarklets</title>
    <link rel="icon" href="http://separator.mayastudios.com/vert-favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <style>
    body {
        padding: 20px
    }
    </style>
</head>
<body>
    <div class="panel panel-primary">
        <div class="panel-heading">
            <h4 class="panel-title">CRM Bookmarklets</h4>
        </div>
        <div class="list-group">
            <a href='javascript:(function(t){if(t)try{var e=t.Xrm.Page.data.entity.getId();if(!e)return alert("Failed to find id on this form.");window.clipboardData?window.clipboardData.setData("Text",e):window.prompt("Copy to clipboard: Ctrl+C, Enter",e)}catch(r){alert("Error occurred while retrieving record id. "+r.message)}})(function(t){if(!t.APPLICATION_VERSION)return alert("Could not determine the current version of CRM.");if("5.0"===t.APPLICATION_VERSION)return window.top.frames[0];if(/^[6,7,8]\.\d+$/.test(t.APPLICATION_VERSION)){var e=$("#crmContentPanel iframe:not([style*=\"visibility: hidden\"])");return e.length>0&&e[0].contentWindow.Xrm.Page.ui?e[0].contentWindow:alert("[CRM 2013/2015/2016] Could not locate the entity form.")}return t.APPLICATION_VERSION?alert("Unsupported CRM Version Detected: "+t.APPLICATION_VERSION):alert("Unable to detect current CRM Version.")}(window));'class="list-group-item"><span class="glyphicon glyphicon-cog"></span> Entity Id</a>
        
            <a href='javascript:(function(e)%7Be%26%26e.Xrm.Page.ui.controls.forEach(function(e%2Ct)%7Be.__label%3F(e.setLabel(e.__label)%2Ce.__label%3Dnull)%3A(e.__label%3De.getLabel()%2Ce.setLabel(e.getName()))%7D)%7D)(function(e)%7Bif(!e.APPLICATION_VERSION)return alert("Could not determine the current version of CRM.")%3Bif("5.0"%3D%3D%3De.APPLICATION_VERSION)return window.top.frames%5B0%5D%3Bif(%2F%5E%5B6%2C7%2C8%5D%5C.%5Cd%2B%24%2F.test(e.APPLICATION_VERSION))%7Bvar t%3D%24("%23crmContentPanel iframe%3Anot(%5Bstyle*%3D%5C"visibility%3A hidden%5C"%5D)")%3Breturn t.length>0%26%26t%5B0%5D.contentWindow.Xrm.Page.ui%3Ft%5B0%5D.contentWindow%3Aalert("%5BCRM 2013%2F2015%2F2016%5D Could not locate the entity form.")%7D%0Areturn e.APPLICATION_VERSION%3Falert("Unsupported CRM Version Detected%3A "%2Be.APPLICATION_VERSION)%3Aalert("Unable to detect current CRM Version.")%7D(window))%3B' class="list-group-item"><span class="glyphicon glyphicon-book"></span> Toggle schema names</a>

            <a href='javascript:(function()%7Bvar form%3D%24("iframe").filter(function()%7Breturn %24(this).css("visibility")%3D%3D"visible"%7D)%5B0%5D.contentWindow%3Bvar elem%3Dform.document.activeElement%3Bvar id%3Delem.getAttribute("id")%3Bvar control%3Dform.Xrm.Page.getControl(id)%3Bconsole.log(control)%3Bif(control.getDisabled())%7Bcontrol.setDisabled(false)%3B%7Delse%7Bcontrol.setDisabled(true)%3B%7D%0Avoid(0)%3B%7D)()%3B' class="list-group-item"><span class="glyphicon glyphicon-book"></span> Unlock field</a>

            <a href='javascript:%28function%28Xrm%29%7Bvar names%3D%5B"sd_accident"%2C"sd_configurationitemvendor"%2C"sd_configurationitemkind"%2C"sd_timeinterval"%2C"sd_globalconfiguration"%2C"sd_city"%2C"sd_calendar"%2C"sd_degradation"%2C"sd_department"%2C"sd_job"%2C"sd_customfield"%2C"sd_additionalcontact"%2C"sd_dependentserviceci"%2C"sd_shedulertask"%2C"sd_changerequest"%2C"sd_building"%2C"sd_customfieldvalue"%2C"sd_executor"%2C"sd_closecode"%2C"sd_company"%2C"sd_configurationitem"%2C"sd_macroregion"%2C"sd_configurationitemmodel"%2C"sd_incidentobserver"%2C"sd_serviceobserver"%2C"sd_industry"%2C"sd_transfer"%2C"sd_groupprocessperiod"%2C"sd_notificationsubscription"%2C"sd_recipient"%2C"sd_ciuser"%2C"sd_room"%2C"sd_consumer"%2C"sd_portalprivilege"%2C"sd_priority"%2C"sd_reason"%2C"sd_delayreason"%2C"sd_problem"%2C"sd_project"%2C"sd_region"%2C"sd_servicelink"%2C"sd_service"%2C"sd_agreementservice"%2C"sd_serviceagreement"%2C"sd_system"%2C"sd_sysnotification"%2C"sd_sms"%2C"sd_negotiation"%2C"sd_term"%2C"sd_status"%2C"sd_accidentstatus"%2C"sd_substatus"%2C"sd_referenceentity"%2C"sd_techservice"%2C"sd_customfieldtypehpsm"%2C"sd_servertype"%2C"sd_salepoint"%2C"sd_branch"%2C"sd_templateparameters"%2C"sd_timekpiinstance"%2C"sd_custompicklistvalue"%5D%0Avar standardCodes%3D%7Baccount%3A1%2Ccontact%3A2%2Copportunity%3A3%2Clead%3A4%2Cannotation%3A5%2Cbusinessunitmap%3A6%2Cowner%3A7%2Csystemuser%3A8%2Cteam%3A9%2Cbusinessunit%3A10%2Cprincipalobjectaccess%3A11%2Croleprivileges%3A12%2Csystemuserlicenses%3A13%2Csystemuserprincipals%3A14%2Csystemuserroles%3A15%2Caccountleads%3A16%2Ccontactinvoices%3A17%2Ccontactquotes%3A18%2Ccontactorders%3A19%2Cservicecontractcontacts%3A20%2Cproductsalesliterature%3A21%2Ccontactleads%3A22%2Cteammembership%3A23%2Cleadcompetitors%3A24%2Copportunitycompetitors%3A25%2Ccompetitorsalesliterature%3A26%2Cleadproduct%3A27%2Croletemplateprivileges%3A28%2Csubscription%3A29%2Cfiltertemplate%3A30%2Cprivilegeobjecttypecodes%3A31%2Csalesprocessinstance%3A32%2Csubscriptionsyncinfo%3A33%2Csubscriptiontrackingdeletedobject%3A35%2Cclientupdate%3A36%2Csubscriptionmanuallytrackedobject%3A37%2Cteamroles%3A40%2Cprincipalentitymap%3A41%2Csystemuserbusinessunitentitymap%3A42%2Cprincipalattributeaccessmap%3A43%2Cprincipalobjectattributeaccess%3A44%2Cprincipalobjectaccessreadsnapshot%3A90%2Crecordcountsnapshot%3A91%2Cincident%3A112%2Ccompetitor%3A123%2Cdocumentindex%3A126%2Ckbarticle%3A127%2Csubject%3A129%2Cbusinessunitnewsarticle%3A132%2Cactivityparty%3A135%2Cusersettings%3A150%2Cactivitymimeattachment%3A1001%2Cattachment%3A1002%2Cinternaladdress%3A1003%2Ccompetitoraddress%3A1004%2Ccompetitorproduct%3A1006%2Ccontract%3A1010%2Ccontractdetail%3A1011%2Cdiscount%3A1013%2Ckbarticletemplate%3A1016%2Cleadaddress%3A1017%2Corganization%3A1019%2Corganizationui%3A1021%2Cpricelevel%3A1022%2Cprivilege%3A1023%2Cproduct%3A1024%2Cproductassociation%3A1025%2Cproductpricelevel%3A1026%2Cproductsubstitute%3A1028%2Csystemform%3A1030%2Cuserform%3A1031%2Crole%3A1036%2Croletemplate%3A1037%2Csalesliterature%3A1038%2Csavedquery%3A1039%2Cstringmap%3A1043%2Cuom%3A1055%2Cuomschedule%3A1056%2Csalesliteratureitem%3A1070%2Ccustomeraddress%3A1071%2Csubscriptionclients%3A1072%2Cstatusmap%3A1075%2Cdiscounttype%3A1080%2Ckbarticlecomment%3A1082%2Copportunityproduct%3A1083%2Cquote%3A1084%2Cquotedetail%3A1085%2Cuserfiscalcalendar%3A1086%2Csalesorder%3A1088%2Csalesorderdetail%3A1089%2Cinvoice%3A1090%2Cinvoicedetail%3A1091%2Csavedqueryvisualization%3A1111%2Cuserqueryvisualization%3A1112%2Cribbontabtocommandmap%3A1113%2Cribboncontextgroup%3A1115%2Cribboncommand%3A1116%2Cribbonrule%3A1117%2Cribboncustomization%3A1120%2Cribbondiff%3A1130%2Creplicationbacklog%3A1140%2Cfieldsecurityprofile%3A1200%2Cfieldpermission%3A1201%2Csystemuserprofiles%3A1202%2Cteamprofiles%3A1203%2Cannualfiscalcalendar%3A2e3%2Csemiannualfiscalcalendar%3A2001%2Cquarterlyfiscalcalendar%3A2002%2Cmonthlyfiscalcalendar%3A2003%2Cfixedmonthlyfiscalcalendar%3A2004%2Ctemplate%3A2010%2Ccontracttemplate%3A2011%2Cunresolvedaddress%3A2012%2Cterritory%3A2013%2Cqueue%3A2020%2Clicense%3A2027%2Cqueueitem%3A2029%2Cuserentityuisettings%3A2500%2Cuserentityinstancedata%3A2501%2Cintegrationstatus%3A3e3%2Cconnectionrole%3A3231%2Cconnectionroleassociation%3A3232%2Cconnectionroleobjecttypecode%3A3233%2Cconnection%3A3234%2Cequipment%3A4e3%2Cservice%3A4001%2Cresource%3A4002%2Ccalendar%3A4003%2Ccalendarrule%3A4004%2Cresourcegroup%3A4005%2Cresourcespec%3A4006%2Cconstraintbasedgroup%3A4007%2Csite%3A4009%2Cresourcegroupexpansion%3A4010%2Cinterprocesslock%3A4011%2Cemailhash%3A4023%2Cdisplaystringmap%3A4101%2Cdisplaystring%3A4102%2Cnotification%3A4110%2Cactivitypointer%3A4200%2Cappointment%3A4201%2Cemail%3A4202%2Cfax%3A4204%2Cincidentresolution%3A4206%2Cletter%3A4207%2Copportunityclose%3A4208%2Corderclose%3A4209%2Cphonecall%3A4210%2Cquoteclose%3A4211%2Ctask%3A4212%2Cserviceappointment%3A4214%2Ccommitment%3A4215%2Cuserquery%3A4230%2Crecurrencerule%3A4250%2Crecurringappointmentmaster%3A4251%2Cemailsearch%3A4299%2Clist%3A4300%2Clistmember%3A4301%2Ccampaign%3A4400%2Ccampaignresponse%3A4401%2Ccampaignactivity%3A4402%2Ccampaignitem%3A4403%2Ccampaignactivityitem%3A4404%2Cbulkoperationlog%3A4405%2Cbulkoperation%3A4406%2C"import"%3A4410%2Cimportmap%3A4411%2Cimportfile%3A4412%2Cimportdata%3A4413%2Cduplicaterule%3A4414%2Cduplicaterecord%3A4415%2Cduplicaterulecondition%3A4416%2Ccolumnmapping%3A4417%2Cpicklistmapping%3A4418%2Clookupmapping%3A4419%2Cownermapping%3A4420%2Cimportlog%3A4423%2Cbulkdeleteoperation%3A4424%2Cbulkdeletefailure%3A4425%2Ctransformationmapping%3A4426%2Ctransformationparametermapping%3A4427%2Cimportentitymapping%3A4428%2Crelationshiprole%3A4500%2Crelationshiprolemap%3A4501%2Ccustomerrelationship%3A4502%2Ccustomeropportunityrole%3A4503%2Caudit%3A4567%2Centitymap%3A4600%2Cattributemap%3A4601%2Cplugintype%3A4602%2Cplugintypestatistic%3A4603%2Cpluginassembly%3A4605%2Csdkmessage%3A4606%2Csdkmessagefilter%3A4607%2Csdkmessageprocessingstep%3A4608%2Csdkmessagerequest%3A4609%2Csdkmessageresponse%3A4610%2Csdkmessageresponsefield%3A4611%2Csdkmessagepair%3A4613%2Csdkmessagerequestfield%3A4614%2Csdkmessageprocessingstepimage%3A4615%2Csdkmessageprocessingstepsecureconfig%3A4616%2Cserviceendpoint%3A4618%2Casyncoperation%3A4700%2Cworkflowwaitsubscription%3A4702%2Cworkflow%3A4703%2Cworkflowdependency%3A4704%2Cisvconfig%3A4705%2Cworkflowlog%3A4706%2Capplicationfile%3A4707%2Corganizationstatistic%3A4708%2Csitemap%3A4709%2Cprocesssession%3A4710%2Cwebwizard%3A4800%2Cwizardpage%3A4802%2Cwizardaccessprivilege%3A4803%2Ctimezonedefinition%3A4810%2Ctimezonerule%3A4811%2Ctimezonelocalizedname%3A4812%2Csolution%3A7100%2Cpublisher%3A7101%2Cpublisheraddress%3A7102%2Csolutioncomponent%3A7103%2Cdependency%3A7105%2Cdependencynode%3A7106%2Cinvaliddependency%3A7107%2Cpost%3A8e3%2Cpostrole%3A8001%2Cpostregarding%3A8002%2Cpostfollow%3A8003%2Cpostcomment%3A8005%2Cpostlike%3A8006%2Creport%3A9100%2Creportentity%3A9101%2Creportcategory%3A9102%2Creportvisibility%3A9103%2Creportlink%3A9104%2Ctransactioncurrency%3A9105%2Cmailmergetemplate%3A9106%2Cimportjob%3A9107%2Cwebresource%3A9333%2Csharepointsite%3A9502%2Csharepointdocumentlocation%3A9508%2Cgoal%3A9600%2Cgoalrollupquery%3A9602%2Cmetric%3A9603%2Crollupfield%3A9604%7D%3Bfunction getTypeCode%28entityName%29%7Bvar typeCode%3D""%3Btry%7Bvar lookupService%3Dnew parent.RemoteCommand%28"LookupService"%2C"RetrieveTypeCode"%29%3BlookupService.SetParameter%28"entityName"%2CentityName%29%3Bvar result%3DlookupService.Execute%28%29%3Bif%28result.Success%26%26typeof result.ReturnValue%3D%3D"number"%29%7BtypeCode%3Dresult.ReturnValue.toString%28%29%3B%7D%7D%0Afinally%7Breturn typeCode%3B%7D%7D%0Afunction getEntityName%28typeCode%29%7Bfor%28var i%3D0%3Bi<names.length%3Bi++%29%7Bvar c%3DgetTypeCode%28names%5Bi%5D%29%3Bif%28c%3D%3DtypeCode%29%7Breturn names%5Bi%5D%3B%7D%7D%0Areturn""%3B%7D%0Avar input%3Dprompt%28"Enter entity code/name"%29%3Bif%28input%21%3D%3Dnull%26%26input%21%3D%3D""%29%7Bvar numInput%3DparseInt%28input%29%3Bvar result%3Bif%28isNaN%28numInput%29%29%7Bif%28input.startsWith%28"sd"%29%29%7Bresult%3DgetTypeCode%28input%29%3B%7Delse%7Bresult%3DstandardCodes%5Binput.toLowerCase%28%29%5D%3B%7D%7Delse%7Bif%28numInput>10000%29%7Bresult%3DgetEntityName%28numInput%29%3B%7Delse%7Bfor%28var name in standardCodes%29%7Bif%28standardCodes%5Bname%5D%3D%3D%3DnumInput%29%7Bresult%3Dname%3Bbreak%3B%7D%7D%7D%7D%0Awindow.prompt%28"Copy to clipboard%3A Ctrl+C%2C Enter"%2Cresult%29%3B%7D%7D%28window.frames%5B0%5D.Xrm%21%3Dnull%3Fwindow.frames%5B0%5D.Xrm%3Awindow.frames%5B1%5D.Xrm%29%29%3B' class="list-group-item"><span class="glyphicon glyphicon-book"></span> Type codes</a>

            <a href='javascript:(function () { var form = $("iframe").filter(function () { return $(this).css("visibility") == "visible" })[0].contentWindow; try { var etc = form.Xrm.Page.context.getQueryStringParameters().etc; } catch (e) { } window.open(form.Xrm.Page.context.getClientUrl() + "/tools/solution/edit.aspx?def_category=9801&def_type=" + etc + "&id=%"+"7bfd140aaf-4df4-11dd-bd17-0019b9312238%"+"7d");})();' class="list-group-item"><span class="glyphicon glyphicon-book"></span> Entity editor</a>

            <a href='javascript: (function () { var form = $("iframe").filter(function () { return $(this).css("visibility") == "visible" })[0].contentWindow; var elem = form.document.activeElement; var id = elem.getAttribute("id"); var guid = null; var type = null; if (elem.getAttribute("isInlineLookup") == "true") { guid = elem.getAttribute("oid"); type = elem.getAttribute("otypename") } else if (id != null) { var pos = id.lastIndexOf("_"); if (pos > -1) { var suffix = id.substring(pos + 1); if (["ledit", "lookupDiv", "i"].indexOf(suffix) > -1) { id = id.substring(0, pos) } id = id.replace("_i_ledit_multi", "").replace("_ledit_multi", "") } var control = form.Xrm.Page.getControl(id); if (control != null) { var field = control.getAttribute(); if (field != null) { var value = field.getValue(); if (value != null) { var record = value[value.length - 1]; guid = record.id; type = record.entityType } } } } if (guid != null && guid != "" && type != null && type != "") { var url = form.Xrm.Page.context.getClientUrl() + "/main.aspx?etn=" + type + "&id=" + guid + "&pagetype=entityrecord"; window.open(url) } else { alert("Unable to open record. Make sure you clicked into a lookup field with a value.") } void (0); })();' class="list-group-item"><span class="glyphicon glyphicon-book"></span> Open lookup</a>

            <a href='javascript:%28function%28%29%7Bvar form%3D%24%28"iframe"%29.filter%28function%28%29%7Breturn %24%28this%29.css%28"visibility"%29%3D%3D"visible"%7D%29%5B0%5D.contentWindow%3Bvar elem%3Dform.document.activeElement%3Bvar id%3Delem.getAttribute%28"id"%29%3Bvar guid%3Dnull%3Bvar type%3Dnull%3Bif%28elem.getAttribute%28"isInlineLookup"%29%3D%3D"true"%29%7Bguid%3Delem.getAttribute%28"oid"%29%3Btype%3Delem.getAttribute%28"otypename"%29%7Delse if%28id%21%3Dnull%29%7Bvar pos%3Did.lastIndexOf%28"_"%29%3Bif%28pos>-1%29%7Bvar suffix%3Did.substring%28pos+1%29%3Bif%28%5B"ledit"%2C"lookupDiv"%2C"i"%5D.indexOf%28suffix%29>-1%29%7Bid%3Did.substring%280%2Cpos%29%7D%0Aid%3Did.replace%28"_i_ledit_multi"%2C""%29.replace%28"_ledit_multi"%2C""%29%7D%0Avar control%3Dform.Xrm.Page.getControl%28id%29%3Bif%28control%21%3Dnull%29%7Bvar field%3Dcontrol.getAttribute%28%29%3Bif%28field%21%3Dnull%29%7Bvar value%3Dfield.getValue%28%29%3Bif%28value%21%3Dnull%29%7Bvar record%3Dvalue%5Bvalue.length-1%5D%3Bguid%3Drecord.id%3Btype%3Drecord.entityType%7D%7D%7D%7D%0Aif%28guid%21%3Dnull%26%26guid%21%3D""%26%26type%21%3Dnull%26%26type%21%3D""%29%7Bwindow.prompt%28"Copy to clipboard%3A Ctrl+C%2C Enter"%2Cguid%29%7Delse%7Balert%28"Unable to open record. Make sure you%27re clicked into a lookup field with a value."%29%7D%0Avoid%280%29%3B%7D%29%28%29%3B' class="list-group-item"><span class="glyphicon glyphicon-book"></span> Lookup Id</a>

            <a href='javascript:(function(t){t&&(t.Xrm.Page.ui.controls.forEach(function(t,e){t.setVisible(!0)}),t.Xrm.Page.ui.tabs.forEach(function(t,e){t.setVisible(!0),t.sections.forEach(function(t,e){t.setVisible(!0)})}))})(function(t){if(!t.APPLICATION_VERSION)return alert("Could not determine the current version of CRM.");if("5.0"===t.APPLICATION_VERSION)return window.top.frames[0];if(/^[6,7,8]\.\d+$/.test(t.APPLICATION_VERSION)){var e=$("#crmContentPanel iframe:not([style*=\"visibility: hidden\"])");return e.length>0&&e[0].contentWindow.Xrm.Page.ui?e[0].contentWindow:alert("[CRM 2013/2015/2016] Could not locate the entity form.")}return t.APPLICATION_VERSION?alert("Unsupported CRM Version Detected: "+t.APPLICATION_VERSION):alert("Unable to detect current CRM Version.")}(window));' class="list-group-item"><span class="glyphicon glyphicon-book"></span> Display all fields</a>

            <a href='javascript:%28function%28t%29%7BString.prototype.paddingLeft%3Dfunction%28paddingValue%29%7Breturn String%28paddingValue+this%29.slice%28-paddingValue.length%29%3B%7D%0Aif%28t%29%7Bvar e%3D%5B%5D%3Bt.Xrm.Page.data.entity.attributes.forEach%28function%28t%2Cr%29%7Bt%26%26t.getIsDirty%26%26t.getIsDirty%28%29%26%26e.push%28%7Bname%3At.controls.getAll%28%29%5B0%5D.getLabel%28%29%2CcrmName%3At.getName%28%29%2CtoString%3Afunction%28%29%7Breturn this.name+"     "+this.crmName%3B%7D%7D%29%3B%7D%29%3Be.sort%28function%28a%2Cb%29%7Bif%28a.name>b.name%29%7Breturn 1%3B%7D%0Aif%28a.name<b.name%29%7Breturn-1%3B%7D%0Areturn 0%3B%7D%29%3Be%26%26e.length%3Fconsole.log%28e.join%28"%5Cn"%29%29%26%26window.prompt%28"The following attributes are currently dirty%3A Ctrl+C%2C Enter"%2Ce.join%28"%5Cn"%29%29%3Aalert%28"No attributes appear to be dirty on the current form."%29%7D%7D%29%28function%28t%29%7Bif%28%21t.APPLICATION_VERSION%29return alert%28"Could not determine the current version of CRM."%29%3Bif%28"5.0"%3D%3D%3Dt.APPLICATION_VERSION%29return window.top.frames%5B0%5D%3Bif%28/%5E%5B6%2C7%2C8%5D%5C.%5Cd+%24/.test%28t.APPLICATION_VERSION%29%29%7Bvar e%3D%24%28"%23crmContentPanel iframe%3Anot%28%5Bstyle*%3D%5C"visibility%3A hidden%5C"%5D%29"%29%3Breturn e.length>0%26%26e%5B0%5D.contentWindow.Xrm.Page.ui%3Fe%5B0%5D.contentWindow%3Aalert%28"%5BCRM 2013/2015/2016%5D Could not locate the entity form."%29%7D%0Areturn t.APPLICATION_VERSION%3Falert%28"Unsupported CRM Version Detected%3A "+t.APPLICATION_VERSION%29%3Aalert%28"Unable to detect current CRM Version."%29%7D%28window%29%29%3B' class="list-group-item"><span class="glyphicon glyphicon-book"></span> Dirty fields</a>
        </div>
        <div class="panel-footer">
            Drag to bookmarks bar <span class="glyphicon glyphicon-hand-up"></span>
        </div>
    </div>
    <script src="js/bootstrap.min.js"></script>
</body>
</html>
